webpackJsonp([3,14,45],{A67E:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("3cXf"),l=a.n(i),n=a("I29D"),o=a.n(n),s={data:function(){return{loading:!1,visible:!1,dialogvisible:!1,uploadVisible:!1,modifyAccountVisible:!1,filecatalogid:"",skillfileCatalogOptions:[],fileList:[],url:"",uploadformdata:new FormData,delfileIds:[]}},created:function(){},methods:{getDataList:function(e,t,a){this.loading=!0,this.$http({url:this.$http.adornUrl("/sys/config/queryrange"),method:"get",params:this.$http.adornParams({start:e,end:t})}).then(function(e){var t=e.data;a(t)})},initSkillfileCatalogOptionsCallback:function(e){if(e&&0===e.code){console.log(l()(e)),this.skillfileCatalogOptions=[];var t=0;for(t in e.config)this.skillfileCatalogOptions.push({value:e.config[t].paramKey,label:e.config[t].paramValue})}this.loading=!1},closeHandle:function(){this.fileList=[]},init:function(e){this.visible=!0,this.getDataList(70,79,this.initSkillfileCatalogOptionsCallback)},dataFormSubmit:function(){this.submitUpload()},handlePreview:function(e){console.log("handlePreview:"+e)},handleRemove:function(e,t){console.log("handleRemove file: "+l()(e)+"!!--!!fileList: "+l()(t))},onUploadStatuChange:function(e,t){this.fileList=t,console.log("onUploadStatuChange file: "+l()(e)+"!!--!!fileList: "+l()(t))},deleteFileHandler:function(e,t){var a=void 0;for(a in this.fileList){var i=this.fileList[a];console.log("fileJson:"+l()(this.fileList[a])+",file uid:"+i.uid+", delUid:"+e)}a>-1&&this.fileList.splice(a,1),console.log("deleted filelist:"+l()(this.fileList))},uploadfile:function(e){console.log(e),this.uploadformdata.append("files",e.file)},submitUpload:function(){var e=this;this.uploadformdata=new FormData,this.$refs.upload.submit();this.isUploadOk=!1,this.isUploading=!0,o.a.post(this.$http.adornUrl("/fenhuo/file/upload?type=1&filecatalogid="+this.filecatalogid+"&token="+this.$cookie.get("token")),this.uploadformdata,{headers:{"Content-Type":"multipart/form-data"}}).then(function(t){e.fileList=[],console.log(t),0===t.data.code?e.$message({message:"操作成功",type:"success",duration:1500,onClose:function(){e.$refs.catalogform.resetFields(),e.visible=!1,e.$emit("refreshDataList")}}):500===t.data.code&&e.$message({message:"文件名已存在",type:"error",duration:1500,onClose:function(){e.$refs.catalogform.resetFields(),e.visible=!1,e.$emit("refreshDataList")}})}).catch(function(e){console.log(e)})},uploadSuccess:function(e,t,a){console.log("-----------------------uploadSuccess-------------"),console.log("response:"+l()(e)),console.log("file:"+l()(t)),console.log("fileList:"+l()(a))},handleClick:function(e,t){console.log(e,t)},beforeUpload:function(e){console.log(e);var t=e.name.substring(e.name.lastIndexOf(".")+1),a="xls"===t,i="xlsx"===t,l="doc"===t,n="docx"===t,o="pdf"===t,s="png"===t,r="jpg"===t,c="jpeg"===t,d="ppt"===t,f="pptx"===t,u=e.size/1024/1024<50;return a||i||l||n||o||s||r||c||d||f||this.$message({message:"上传文件只能是 图片、或者文档格式!",type:"warning"}),u||this.$message({message:"上传文件大小不能超过 50MB!",type:"warning"}),(a||i||l||n||o||s||r||c||d||f)&&u}}},r={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"项目创建","close-on-click-modal":!1,visible:e.visible,"v-loading":e.loading,width:"50%"},on:{close:e.closeHandle,"update:visible":function(t){e.visible=t}}},[a("el-row",[a("el-col",{attrs:{span:24}},[a("el-card",{attrs:{shadow:"always"}},[a("el-row",[a("el-col",{attrs:{span:24}},[a("el-form",{ref:"catalogform",staticStyle:{width:"100%"},attrs:{size:"medium"}},[a("el-form-item",{attrs:{label:"技术文档类别"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择技术文档类别"},model:{value:e.filecatalogid,callback:function(t){e.filecatalogid=t},expression:"filecatalogid"}},e._l(e.skillfileCatalogOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1)],1)],1),e._v(" "),a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:19}},[a("el-container",[a("span",[a("h2",{staticStyle:{"line-height":"0px"}},[e._v("技术文档")])])])],1),e._v(" "),a("el-col",{attrs:{span:3,offset:2}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"#",accept:".xls,.xlsx,.doc,.docx,.pdf,.png,.jpg,.jpeg","on-preview":e.handlePreview,"on-change":e.onUploadStatuChange,"before-upload":e.beforeUpload,multiple:"","on-remove":e.handleRemove,"on-success":e.uploadSuccess,"file-list":e.fileList,"show-file-list":!1,"auto-upload":!1,"http-request":e.uploadfile}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("添加文件")])],1)],1)],1),e._v(" "),a("el-divider"),e._v(" "),a("ul",{staticClass:"infinite-list",staticStyle:{overflow:"auto"}},e._l(e.fileList,function(t){return a("el-row",{key:t.uid},[a("li",{staticClass:"infinite-list-item"},[a("el-col",{attrs:{span:8,offset:1}},[a("h3",[e._v(e._s(t.name))])]),e._v(" "),a("el-col",{attrs:{span:5,offset:10}},[a("el-link",{attrs:{type:"primary",underline:!1},on:{click:function(a){e.deleteFileHandler(t.uid,t.name)}}},[e._v("删除")])],1)],1)])}))],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.visible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.dataFormSubmit()}}},[e._v("确定")])],1)],1)},staticRenderFns:[]};var c=a("46Yf")(s,r,!1,function(e){a("Q8wE")},"data-v-799682a8",null);t.default=c.exports},BFll:function(e,t,a){(e.exports=a("acE3")(!1)).push([e.i,"\n.infinite-list[data-v-799682a8] {\r\n  list-style: none;\n}\n.infinite-list .infinite-list-item[data-v-799682a8] {\r\n  display: -webkit-box;\r\n  display: -ms-flexbox;\r\n  display: flex;\r\n  -webkit-box-align: center;\r\n      -ms-flex-align: center;\r\n          align-items: center;\r\n  -webkit-box-pack: center;\r\n      -ms-flex-pack: center;\r\n          justify-content: center;\r\n  height: 50px;\r\n  background: #f1f1f1;\r\n  color: #1b1919;\r\n  margin: 10px 0px;\r\n  border-bottom: black;\r\n  border-bottom-width: thin;\r\n  border-bottom-style: solid;\n}\r\n",""])},Cbte:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("3cXf"),l=a.n(i),n=a("I29D"),o=a.n(n),s=a("Dj1v"),r=a("lm2O"),c=a.n(r),d=a("A67E"),f={data:function(){return{foundCount:0,selectedCount:0,dataForm:{key:""},viewVisible:!1,dataList:[],pageIndex:1,pageSize:10,totalPage:0,dataListLoading:!1,dataListSelections:[],zbxdatainfo:[],selectedprojectid:"",tabelTitle:"测试title",inactive:!1,uploadurl:this.$http.adornUrl("/fenhuo/file/upload?type=1&token="+this.$cookie.get("token")),fileList:[],uploadformdata:new FormData,searchViewVisible:!1}},components:{searchView:s.default,addOrUpdateView:d.default},created:function(){this.getDataList(null)},methods:{getDataList:function(e){var t=this;this.dataListLoading=!0,this.$http({url:this.$http.adornUrl("/fenhuo/file/skilllist"),method:"get",params:this.$http.adornParams(c()({type:1,page:this.pageIndex,limit:this.pageSize,key:this.dataForm.key},e))}).then(function(e){var a=e.data;a&&0===a.code?(t.dataList=a.page.list,t.totalPage=a.page.totalCount,t.foundCount=t.dataList.length):(t.dataList=[],t.totalPage=0,t.foundCount=0),t.dataListLoading=!1,t.viewVisible=!1})},deleteHandle:function(e){var t=this;console.log("this.dataListSelections"+l()(this.dataListSelections));var a=e?[e]:this.dataListSelections.map(function(e){return e.fileid});this.$confirm("确定对[id="+a.join(",")+"]进行["+(1===a.length?"删除":"批量删除")+"]操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$http({url:t.$http.adornUrl("/fenhuo/file/delete"),method:"post",data:t.$http.adornData(a,!1)}).then(function(e){var a=e.data;a&&0===a.code?t.$message({message:"操作成功",type:"success",duration:1500,onClose:function(){t.getDataList(null)}}):t.$message.error(a.msg)})}).catch(function(){})},downloadHandle:function(e){window.location.href=this.$http.adornUrl("/doc/skill/"+e)},closeProject:function(){var e=this;console.log("this.dataListSelections"+l()(this.dataListSelections));var t=this.dataListSelections.map(function(e){return e.fileid});this.$confirm("确定对[id="+t.join(",")+"]进行["+(1===t.length?"关闭":"批量关闭")+"]操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$http({url:e.$http.adornUrl("/fenhuo/fenhuoprojectinfo/close"),method:"post",data:e.$http.adornData(t,!1)}).then(function(t){var a=t.data;a&&0===a.code?e.$message({message:"操作成功",type:"success",duration:1500,onClose:function(){e.getDataList(null)}}):e.$message.error(a.msg)})}).catch(function(){})},uploadfile:function(e){console.log("###############uploadfile################33"),console.log(e),console.log("###############uploadfile##################"),this.uploadformdata.append("files",e.file)},handlePreview:function(e){console.log("handlePreview:"+e)},handleRemove:function(e,t){console.log("handleRemove file: "+l()(e)+"!!--!!fileList: "+l()(t))},onUploadStatuChange:function(e,t){this.fileList=t,console.log("onUploadStatuChange file: "+l()(e)+"!!--!!fileList: "+l()(t))},uploadSuccess:function(e,t,a){console.log("-----------------------uploadSuccess-------------"),console.log("response:"+l()(e)),console.log("file:"+l()(t)),console.log("fileList:"+l()(a)),this.getDataList(null)},submitUpload:function(e){var t=this;this.uploadformdata=new FormData,this.$refs.upload.submit(),e?this.uploadformdata.append("deleteFiles",this.delfilenames):this.uploadformdata.append("deleteFiles",[]);o.a.post(this.$http.adornUrl("/fenhuo/fenhuoprojectinfo/upload/"+e+"?token="+this.$cookie.get("token")),this.uploadformdata,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){t.fileList=[],console.log(e)}).catch(function(e){console.log(e)})},getZbxinfoAndshowView:function(e){this.selectedprojectid=e},selectionChangeHandle:function(e){console.log(e),this.dataListSelections=e,this.selectedCount=this.dataListSelections.length},addOrUpdateHandle:function(e){var t=this;this.viewVisible=!0,this.$nextTick(function(){t.$refs.addupdateView.init(e)})},toggleSearchView:function(){var e=this;this.searchViewVisible?(this.$nextTick(function(){e.$refs.searchView.destory()}),this.searchViewVisible=!1,this.getDataList(null)):(this.searchViewVisible=!0,this.$nextTick(function(){e.$refs.searchView.init()}))},skillfileSearchHandle:function(e){var t={startDate:e.dateRange?e.dateRange[0]:"",endDate:e.dateRange?e.dateRange[1]:"",techcatalogid:e.techcatalogid,filtypename:e.filtypename,creatorname:e.creatorname};this.getDataList(t)},sizeChangeHandle:function(e){this.pageSize=e,this.pageIndex=1,this.getDataList(null)},currentChangeHandle:function(e){this.pageIndex=e,this.getDataList(null)}}},u={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mod-log"},[a("el-tag",{attrs:{effect:"plain",type:"info"}},[e._v("共搜索到"+e._s(e.foundCount)+"个技术文件")]),e._v(" "),a("el-form",{attrs:{inline:!0,model:e.dataForm},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.getDataList()}}},[a("el-form-item",[e.isAuth("fenhuo:skillfile:upload")?a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){e.addOrUpdateHandle()},refreshDataList:e.getDataList}},[e._v("上传文件")]):e._e()],1),e._v(" "),a("el-form-item",[e.isAuth("fenhuo:skillfile:delete")?a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){e.deleteHandle()}}},[e._v("删除文件")]):e._e()],1),e._v(" "),a("el-form-item",[e.isAuth("fenhuo:skillfile:search")?a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){e.toggleSearchView()}}},[e._v("高级搜索")]):e._e()],1),e._v(" "),e.searchViewVisible?a("searchView",{ref:"searchView",on:{searchAction:e.skillfileSearchHandle}}):e._e()],1),e._v(" "),a("el-alert",{attrs:{type:"info","show-icon":""}},[e._v("已选择"+e._s(e.selectedCount)+"项")]),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.dataListLoading,expression:"dataListLoading"}],staticStyle:{width:"100%"},attrs:{data:e.dataList,border:"",stripe:""},on:{"selection-change":e.selectionChangeHandle}},[a("el-table-column",{attrs:{fixed:"",type:"selection",width:"40"}}),e._v(" "),a("el-table-column",{attrs:{prop:"createdatetime","header-align":"center",align:"center",width:"160",label:"项目创建时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"techcatalogname","header-align":"center",align:"center",width:"410",label:"技术类别"}}),e._v(" "),a("el-table-column",{attrs:{prop:"filename","header-align":"center",align:"center",width:"410",label:"文件名称"}}),e._v(" "),a("el-table-column",{attrs:{prop:"filetype","header-align":"center",align:"center",width:"120","show-overflow-tooltip":!0,label:"文件类型"}}),e._v(" "),a("el-table-column",{attrs:{prop:"creator","header-align":"center",align:"center",width:"180","show-overflow-tooltip":!0,label:"上传人员"}}),e._v(" "),e.isAuth("fenhuo:fenhuoprojectinfo:update")?a("el-table-column",{attrs:{fixed:"right","header-align":"center",align:"center",width:"150",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[e.isAuth("fenhuo:skillfile:download")?a("el-button",{attrs:{type:"text"},on:{click:function(a){e.downloadHandle(t.row.filename)}}},[e._v("下载")]):e._e(),e._v(" "),e.isAuth("fenhuo:skillfile:delete")?a("el-button",{attrs:{type:"text"},on:{click:function(a){e.deleteHandle(t.row.fileid)}}},[e._v("删除")]):e._e()]}}])}):e._e()],1),e._v(" "),a("el-pagination",{attrs:{"current-page":e.pageIndex,"page-sizes":[10,20,50,100],"page-size":e.pageSize,total:e.totalPage,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.sizeChangeHandle,"current-change":e.currentChangeHandle}}),e._v(" "),e.viewVisible?a("addOrUpdateView",{ref:"addupdateView",on:{refreshDataList:e.getDataList}}):e._e()],1)},staticRenderFns:[]};var h=a("46Yf")(f,u,!1,function(e){a("ruV1")},"data-v-aee00950",null);t.default=h.exports},Dj1v:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("3cXf"),l=a.n(i),n={data:function(){return{searchData:{dateRange:"",techcatalogid:"",filtypename:"",creatorname:"",skillfileCatalogOptions:[]},searchVisible:!1}},methods:{init:function(){this.searchVisible=!0,this.getDataList(70,79,this.initSkillfileCatalogOptionsCallback)},getDataList:function(e,t,a){this.loading=!0,this.$http({url:this.$http.adornUrl("/sys/config/queryrange"),method:"get",params:this.$http.adornParams({start:e,end:t})}).then(function(e){var t=e.data;a(t)})},initSkillfileCatalogOptionsCallback:function(e){if(e&&0===e.code){console.log(l()(e)),this.searchData.skillfileCatalogOptions=[];var t=0;for(t in e.config)this.searchData.skillfileCatalogOptions.push({value:e.config[t].paramKey,label:e.config[t].paramValue})}this.loading=!1},destory:function(){this.searchData.dateRange="",this.searchData.techcatalogid="",this.searchData.filtypename="",this.searchData.creatorname="",this.searchData.skillfileCatalogOptions=[],this.searchVisible=!1},valueChangeHandle:function(e){console.log(this.searchData),this.$emit("searchAction",this.searchData)}}},o={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.searchVisible?a("el-form",{attrs:{"label-width":"80px"}},[a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{staticStyle:{margin:"5px 0px"},attrs:{label:"创建日期"}},[a("el-date-picker",{attrs:{type:"datetimerange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd"},on:{change:e.valueChangeHandle},model:{value:e.searchData.dateRange,callback:function(t){e.$set(e.searchData,"dateRange",t)},expression:"searchData.dateRange"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{staticStyle:{margin:"5px 0px"},attrs:{label:"技术类别"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择技术文档类别"},on:{change:e.valueChangeHandle},model:{value:e.searchData.techcatalogid,callback:function(t){e.$set(e.searchData,"techcatalogid",t)},expression:"searchData.techcatalogid"}},e._l(e.searchData.skillfileCatalogOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{staticStyle:{margin:"5px 0px"},attrs:{label:"文件类别"}},[a("el-input",{attrs:{placeholder:"请输入内容",clearable:""},on:{change:e.valueChangeHandle},model:{value:e.searchData.filtypename,callback:function(t){e.$set(e.searchData,"filtypename",t)},expression:"searchData.filtypename"}})],1)],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:10}},[a("el-form-item",{staticStyle:{margin:"5px 0px"},attrs:{label:"上传人员"}},[a("el-input",{attrs:{placeholder:"请输入内容",clearable:""},on:{change:e.valueChangeHandle},model:{value:e.searchData.creatorname,callback:function(t){e.$set(e.searchData,"creatorname",t)},expression:"searchData.creatorname"}})],1)],1)],1)],1):e._e()},staticRenderFns:[]},s=a("46Yf")(n,o,!1,null,null,null);t.default=s.exports},Q8wE:function(e,t,a){var i=a("BFll");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a("XkoO")("6902fcb8",i,!0)},mxXR:function(e,t,a){(e.exports=a("acE3")(!1)).push([e.i,"\n.projectactive[data-v-aee00950] {\n  color:green\n}\n.projectinactive[data-v-aee00950] {\n  color: red\n}\n",""])},ruV1:function(e,t,a){var i=a("mxXR");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a("XkoO")("13ed4256",i,!0)}});