webpackJsonp([9],{WNmw:function(e,t,i){var a=i("fnYB");"string"==typeof a&&(a=[[e.i,a,""]]),a.locals&&(e.exports=a.locals);i("XkoO")("4615f014",a,!0)},fnYB:function(e,t,i){(e.exports=i("acE3")(!1)).push([e.i,"\n.mod-demo-echarts > .el-alert {\n  margin-bottom: 10px;\n}\n.mod-demo-echarts > .el-row {\n  margin-top: -10px;\n  margin-bottom: -10px;\n}\n.mod-demo-echarts > .el-row .el-col {\n    padding-top: 10px;\n    padding-bottom: 10px;\n}\n.mod-demo-echarts .chart-box {\n  min-height: 200px;\n}\n.infinite-list {\n  list-style: none;\n}\n.infinite-list .infinite-list-item {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  height: 50px;\n  background: #f1f1f1;\n  color: #1b1919;\n  margin: 10px 0px;\n  border-bottom: black;\n  border-bottom-width: thin;\n  border-bottom-style: solid;\n}\n",""])},kvhC:function(e,t,i){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var a=i("3cXf"),l=i.n(a),n=i("Pg0u"),o=i.n(n),s=i("I29D"),r=i.n(s),d={props:["inactive","tabelTitle","projectid","projtypeid","orgname","address","servicedetail","effectivetime","taskname","zabbixname"],data:function(){return{loadingcss:{text:"loading",color:"#c23531",textColor:"#000",maskColor:"rgba(255, 255, 255, 0.2)",zlevel:0},chartCpuLine:null,pieOption:{backgroundColor:"#2c343c",title:{text:"Customized Pie",left:"center",top:20,textStyle:{color:"#ccc"}},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},visualMap:{show:!1,min:80,max:600,inRange:{colorLightness:[0,1]}},series:[{name:"访问来源",type:"pie",radius:"55%",center:["50%","50%"],data:[{value:335,name:"直接访问"},{value:310,name:"邮件营销"},{value:274,name:"联盟广告"},{value:400,name:"视频广告"},{value:400,name:"搜索引擎"}].sort(function(e,t){return e.value-t.value}),roseType:"radius",label:{normal:{textStyle:{color:"rgba(255, 255, 255, 0.3)"}}},labelLine:{normal:{lineStyle:{color:"rgba(255, 255, 255, 0.3)"},smooth:.2,length:10,length2:20}},itemStyle:{normal:{color:"#c23531",shadowBlur:200,shadowColor:"rgba(0, 0, 0, 0.5)"}},animationType:"scale",animationEasing:"elasticOut",animationDelay:function(e){return 200*Math.random()}}]},cpulineOption:{title:{text:""},tooltip:{trigger:"axis"},legend:{data:[]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},toolbox:{feature:{saveAsImage:{}}},xAxis:{axisLabel:{interval:0,rotate:40},type:"time",boundaryGap:!1},yAxis:{min:0,max:1e3},series:[]},activeName:"first",collapseActiveName:["1","2"],tabinited:{first:!1,second:!1},mngerTbHeads:[{id:"0",propname:"realname",labelname:"真实姓名",widthvalue:"120"},{id:"1",propname:"realname",labelname:"联系人",widthvalue:"120"},{id:"2",propname:"mobile",labelname:"联系方式",widthvalue:"120"}],mainTainTbHeads:[{id:"0",propname:"realname",labelname:"真实姓名",widthvalue:"120"},{id:"1",propname:"realname",labelname:"联系人",widthvalue:"120"},{id:"2",propname:"mobile",labelname:"联系方式",widthvalue:"120"}],AmngeTbHeads:[{id:"0",propname:"realname",labelname:"真实姓名",widthvalue:"120"},{id:"1",propname:"realname",labelname:"联系人",widthvalue:"120"},{id:"2",propname:"mobile",labelname:"联系方式",widthvalue:"120"}],fullscreenLoading:!1,dataListLoading:{mngloading:!1,Amngloading:!1,maintainloading:!0},dataList:{mng:[],Amng:[],maintain:[]},fileList:[],showMathod:"click",zbxhosts:[],selectedhostname:"",zbxitems:[],selectedItemname:"",selectedHostid:"",selectedItemid:"",zbxAuthKey:"",zbxAuthId:"",datepickenabled:!0,dateTimeRange:"",delfileIds:[]}},methods:{init:function(){},popshowinit:function(){this.dataListLoading.Amngloading=!0,this.dataListLoading.mngloading=!0,this.dataListLoading.maintainloading=!1,this.getDataList({roleid:1}),this.getDataList({roleid:2}),this.getDataList({roleid:3}),this.projectRelatedFilelist(),this.getZbxhostsMessageByProjectid()},showChartline:function(){console.log("popover show:",this.projectid),this.$nextTick(function(){})},hideHandler:function(){this.tabinited.first=!1,this.tabinited.second=!1},projectRelatedFileDownload:function(e,t){window.location.href=this.$http.adornUrl("/doc/proj_"+e+"/"+t)},projectRelatedFilelist:function(){var e=this;this.$http({url:this.$http.adornUrl("/fenhuo/fenhuoprojectinfo/projectfilelist/"+this.projectid),method:"get"}).then(function(t){var i=t.data;i&&0===i.code?(e.fileList=i.relatedfilelist,e.fullscreenLoading=!1):e.fileList=[]})},showProjectRelateduser:function(){},getDataList:function(e){var t=this;this.$http({url:this.$http.adornUrl("/fenhuo/fenhuousers/projectlist/"+this.projectid),method:"post",params:this.$http.adornParams(e)}).then(function(i){var a=i.data;a&&0===a.code?(1===e.roleid?(t.dataList.Amng=a.userlist,t.dataListLoading.Amngloading=!1):2===e.roleid?(t.dataList.mng=a.userlist,t.dataListLoading.mngloading=!1):(t.dataList.maintain=a.userlist,t.dataListLoading.maintainloading=!1),console.log(a)):console.log(a)})},initCPUChartLine:function(){var e=this;this.chartCpuLine=o.a.init(this.$refs.J_chartCPULineBox),this.chartCpuLine.showLoading(this.loadingcss),this.$http({url:this.$http.adornUrl("/fenhuo/fenhuozabbixhost/zbxhostiteminfo"),method:"post",params:this.$http.adornParams({itemid:this.selectedItemid,auth:this.zbxAuthKey,id:this.zbxAuthId,from:this.from,till:this.till})}).then(function(t){var i=t.data;if(console.log(i),0===i.code){console.log(i.history),e.cpulineOption.series=[];var a=[],l=[];i.history.result.forEach(function(t){a.push([1e3*parseInt(t.clock),100*parseFloat(t.value)]),l.push(t.value),e.cpulineOption.legend.data.push(e.selectedhostname)});var n=Math.max(l),o=Math.min(l),s={name:e.selectedhostname,type:"line",data:a};e.cpulineOption.yAxis.min=o,e.cpulineOption.yAxis.max=n,e.cpulineOption.title.text=e.selectedItemname,e.cpulineOption.series.push(s)}console.log(i),e.chartCpuLine.hideLoading(),e.chartCpuLine.setOption(e.cpulineOption),e.chartCpuLine.resize()})},convertime:function(e){var t=new Date(e),i=t.getHours(),a=t.getMinutes(),l=t.getSeconds(),n="";return i<10&&(n+="0"),n+=i+":",a<10&&(n+="0"),n+=a+":",l<10&&(n+="0"),n+=l,console.log(n),n},formatDate:function(e,t){/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));var i={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds()};for(var a in i)if(new RegExp("("+a+")").test(t)){var l=i[a]+"";t=t.replace(RegExp.$1,1===RegExp.$1.length?l:this.padLeftZero(l))}return t},handleClick:function(e,t){if("first"===e.name)this.tabinited.first||(this.popshowinit(),this.tabinited.first=!0,console.log("-----------------------------getDatalist"));else if("second"===e.name)if(600===this.projtypeid)this.tabinited.second||(this.showChartline(),this.tabinited.second=!0);else{var i=this.$createElement;this.$notify({title:"不是运维项目",message:i("i",{style:"color: teal"},"该项目不是运维项目，不能够查看主机状态")})}console.log(e,t)},getZbxhostsMessageByProjectid:function(){var e=this;this.$http({url:this.$http.adornUrl("/fenhuo/fenhuozabbixhost/zabbixHostsByProjectid"),method:"post",params:this.$http.adornParams({projectid:this.projectid})}).then(function(t){var i=t.data;if(i&&0===i.code){console.log(i.hosts);var a=i.hosts;e.zbxhosts=[];for(var l=0;l<a.length;l++){var n={};n.value=a[l].hostid,n.label=a[l].name,e.zbxhosts.push(n)}e.zbxAuthKey=i.authKey,e.zbxAuthId=i.id}else console.log(i)})},hostsChangeHandle:function(e,t){for(var i=this,a=0;a<this.zbxhosts.length;a++)if(this.zbxhosts[a].value===e){this.selectedhostname=this.zbxhosts[a].label;break}this.selectedItemid="",console.log("inputValue",e,", selectedHostid",this.selectedHostid),this.$http({url:this.$http.adornUrl("/fenhuo/fenhuozabbixhost/zabbixItemsByHostid"),method:"post",params:this.$http.adornParams({hostid:this.selectedHostid,authkey:this.zbxAuthKey,authid:this.zbxAuthId})}).then(function(e){var t=e.data;if(t&&0===t.code){i.zbxitems=[];for(var a=t.items.result,l=0;l<a.length;l++){var n={};n.value=a[l].itemid,n.label=a[l].key_,i.zbxitems.push(n)}console.log(t)}else console.log(t)})},itemChangeHandle:function(e){for(var t=0;t<this.zbxitems.length;t++)if(this.zbxitems[t].value===e){this.selectedItemname=this.zbxitems[t].label;break}console.log(e),console.log(this.selectedItemid),this.zbxitems.length>0?this.datepickenabled=!1:this.datepickenabled=!0},itemDateChangeHandle:function(e){this.from=this.dateTimeRange[0],this.till=this.dateTimeRange[1],this.initCPUChartLine()},handlePreview:function(e){console.log("handlePreview:"+e)},handleRemove:function(e,t){console.log("handleRemove file: "+l()(e)+"!!--!!fileList: "+l()(t))},onUploadStatuChange:function(e,t){this.fileList=t,console.log("onUploadStatuChange file: "+l()(e)+"!!--!!fileList: "+l()(t))},uploadSuccess:function(e,t,i){console.log("-----------------------uploadSuccess-------------"),console.log("response:"+l()(e)),console.log("file:"+l()(t)),console.log("fileList:"+l()(i))},uploadfile:function(e){console.log(e),this.uploadformdata.append("files",e.file)},uploadProjectFiles:function(e){this.fullscreenLoading=!0,this.submitUpload(e)},submitUpload:function(e){var t=this;this.uploadformdata=new FormData,this.$refs.upload.submit(),e?this.uploadformdata.append("deleteFiles",this.delfileIds):this.uploadformdata.append("deleteFiles",[]);r.a.post(this.$http.adornUrl("/fenhuo/fenhuoprojectinfo/upload/"+e+"?token="+this.$cookie.get("token")),this.uploadformdata,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){t.projectRelatedFilelist(),console.log(e)}).catch(function(e){console.log(e)})},deleteFileHandler:function(e,t){var i=void 0;for(i in this.fileList){var a=this.fileList[i];if(console.log("fileJson:"+l()(this.fileList[i])+",file uid:"+a.uid+", delUid:"+e),a.uid===e){this.projectid&&"success"===a.status&&this.delfileIds.push(a.fileid);break}}i>-1&&this.fileList.splice(i,1),console.log("deleted filelist:"+l()(this.fileList))}}},c={render:function(){var e=this,t=e.$createElement,i=e._self._c||t;return i("el-popover",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{placement:"top",title:e.tabelTitle,width:"1300",trigger:e.showMathod,disabled:e.inactive},on:{hide:e.hideHandler,show:e.popshowinit}},[i("el-tabs",{attrs:{"tab-position":"right"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[i("el-tab-pane",{attrs:{label:"用户管理",name:"first"}},[i("el-row",[i("el-col",{attrs:{span:12}},[i("el-card",[i("div",{staticClass:"chart-box"},[i("el-collapse",{model:{value:e.collapseActiveName,callback:function(t){e.collapseActiveName=t},expression:"collapseActiveName"}},[i("el-collapse-item",{attrs:{title:"项目详细信息",name:"1"}},[i("div",[e._v("单位名称："),i("span",[e._v(e._s(e.orgname))])]),e._v(" "),i("el-divider"),e._v(" "),i("div",[e._v("详细地址："),i("span",[e._v(e._s(e.address))])]),e._v(" "),i("el-divider"),e._v(" "),i("div",[e._v("服务内容："),i("span",[e._v(e._s(e.servicedetail))])]),e._v(" "),i("el-divider"),e._v(" "),i("div",[e._v("服务有效时间："+e._s(e.effectivetime)+"天")]),e._v(" "),i("el-divider"),e._v(" "),i("div",[e._v("固定巡检时间："+e._s(e.taskname))]),e._v(" "),i("el-divider"),e._v(" "),i("div",[e._v("所在zabbix服务器："+e._s(e.zabbixname))]),e._v(" "),i("el-divider")],1),e._v(" "),i("el-collapse-item",{attrs:{title:"项目管理人员",name:"2"}},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.dataListLoading.mngloading,expression:"dataListLoading.mngloading"}],staticStyle:{width:"100%"},attrs:{data:e.dataList.mng,border:""}},e._l(e.mngerTbHeads,function(e){return i("el-table-column",{key:e.id,attrs:{prop:e.propname,label:e.labelname,width:e.widthvalue}})}))],1),e._v(" "),i("el-collapse-item",{attrs:{title:"项目甲方负责人员",name:"3"}},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.dataListLoading.Amngloading,expression:"dataListLoading.Amngloading"}],staticStyle:{width:"100%"},attrs:{data:e.dataList.Amng,border:""}},e._l(e.AmngeTbHeads,function(e){return i("el-table-column",{key:e.id,attrs:{prop:e.propname,label:e.labelname,width:e.widthvalue}})}))],1),e._v(" "),i("el-collapse-item",{attrs:{title:"项目维护人员",name:"4"}},[i("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.dataListLoading.maintainloading,expression:"dataListLoading.maintainloading"}],staticStyle:{width:"100%"},attrs:{data:e.dataList.maintain,border:""}},e._l(e.mainTainTbHeads,function(e){return i("el-table-column",{key:e.id,attrs:{prop:e.propname,label:e.labelname,width:e.widthvalue}})}))],1)],1)],1)])],1),e._v(" "),i("el-col",{attrs:{span:12}},[i("el-card",[i("el-row",{attrs:{gutter:20}},[i("el-col",{attrs:{span:6}},[i("el-container",[i("span",[i("h2",{staticStyle:{"line-height":"0px"}},[e._v("项目附件")])])])],1),e._v(" "),i("el-col",{attrs:{span:6,offset:12}},[i("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"#","on-preview":e.handlePreview,"on-change":e.onUploadStatuChange,multiple:"","on-remove":e.handleRemove,"on-success":e.uploadSuccess,"file-list":e.fileList,"show-file-list":!1,"auto-upload":!1,"http-request":e.uploadfile}},[i("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("添加附件")])],1)],1)],1),e._v(" "),i("div",{staticClass:"chart-box",attrs:{id:"relatedfileid"}},[i("ul",{staticClass:"infinite-list",staticStyle:{overflow:"auto"}},[e._l(e.fileList,function(t){return i("el-row",{key:t.uid},[i("li",{staticClass:"infinite-list-item"},[i("el-col",{attrs:{span:8,offset:1}},[i("h3",[e._v(e._s(t.name))])]),e._v(" "),i("el-col",{attrs:{span:5,offset:10}},[i("el-link",{attrs:{type:"primary",underline:!1},on:{click:function(i){e.projectRelatedFileDownload(e.projectid,t.name)}}},[e._v("下载")]),e._v(" "),i("el-link",{attrs:{type:"primary",underline:!1},on:{click:function(i){e.deleteFileHandler(t.uid,t.name)}}},[e._v("删除")])],1)],1)])}),e._v(" "),i("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[i("el-button",{attrs:{type:"primary"},on:{click:function(t){e.uploadProjectFiles(e.projectid)}}},[e._v("更新文件")])],1)],2)])],1)],1)],1)],1),e._v(" "),i("el-tab-pane",{attrs:{label:"主机监控",name:"second"}},[i("div",{staticClass:"mod-demo-echarts"},[i("el-row",[i("el-col",{attrs:{span:24}},[i("el-card",{directives:[{name:"show",rawName:"v-show",value:600===e.projtypeid,expression:"projtypeid === 600? true:false"}]},[i("el-form",{staticStyle:{width:"100%"}},[i("el-form-item",{staticStyle:{width:"100%"}},[i("el-select",{attrs:{placeholder:"请选择主机"},on:{change:e.hostsChangeHandle},model:{value:e.selectedHostid,callback:function(t){e.selectedHostid=t},expression:"selectedHostid"}},e._l(e.zbxhosts,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}},[i("span",{staticStyle:{float:"left"}},[e._v(e._s(t.label))]),e._v(" "),i("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.value))])])}))],1),e._v(" "),i("el-form-item",{staticStyle:{width:"100%"}},[i("el-select",{attrs:{placeholder:"请选择监控项"},on:{change:e.itemChangeHandle},model:{value:e.selectedItemid,callback:function(t){e.selectedItemid=t},expression:"selectedItemid"}},e._l(e.zbxitems,function(t){return i("el-option",{key:t.value,attrs:{label:t.label,value:t.value}},[i("span",{staticStyle:{float:"left"}},[e._v(e._s(t.label))]),e._v(" "),i("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.value))])])}))],1),e._v(" "),i("el-form-item",{staticStyle:{margin:"5px 0px"},attrs:{label:"监控日期"}},[i("el-date-picker",{attrs:{type:"datetimerange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd HH:mm:ss",disabled:e.datepickenabled},on:{change:e.itemDateChangeHandle},model:{value:e.dateTimeRange,callback:function(t){e.dateTimeRange=t},expression:"dateTimeRange"}})],1)],1),e._v(" "),i("div",{ref:"J_chartCPULineBox",staticClass:"chart-box",attrs:{id:"J_chartCPULineBox"}})],1)],1)],1)],1)])],1),e._v(" "),e._t("default",null,{slot:"reference"})],2)},staticRenderFns:[]};var h=i("46Yf")(d,c,!1,function(e){i("WNmw")},null,null);t.default=h.exports}});