webpackJsonp([2,9,11,39],{"0Eql":function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("3cXf"),o=a.n(i),s=a("yYhT"),n=a("aI4R"),r=a("i0Dp"),l=a("I29D"),d=a.n(l),c={data:function(){return{loading:!1,visible:!1,uploadVisible:!1,modifyAccountVisible:!1,activeName:"first",form:{projectid:"",projectname:"",orgname:"",address:"",governAddr:{province:"",city:"",county:""},servicedetail:"",projectypeid:"",zabbixmngid:"",zabbixname:"",taskid:"",auditstatus:"101",servicestarttime:"",serviceendtime:"",headid:"",servicemid:"",partyaid:"",hostids:"",zbxhostnames:"",zbxusername:"",zbxpassword:"",modifyzbxusername:"",modifyzbxpassword:""},options:s.regionData,selectedOptions:[],serviceOptions:[],zabbixmanagers:[],authstatus:[],checkCycleOptions:[],selectedStartDatetime:"",selectedEndDatetime:"",isAvailble:!0,mngDatalist:[],viewUserShow:{viewMnger:"",viewMaintainEngeer:"",viewAmnger:""},fileList:[],url:"",dataRule:{projectname:[{required:!0,message:"项目名称不能为空",trigger:"blur"}],orgname:[{required:!0,message:"单位名称不能为空",trigger:"blur"}],servicedetail:[{required:!0,message:"服务内容不能为空",trigger:"blur"}],checkTask:[{required:!0,message:"巡检不能为空",trigger:"blur"}]},zbxViewVisible:!1,uploadformdata:new FormData,delfileIds:[],isUploadOk:!1,isUploading:!1,uploadRate:0}},components:{selectView:n.default,selectZabbixmngView:r.default},created:function(){},computed:{endtimePickerOptions:function(){var e=this;return{disabledDate:function(t){return t.getTime()<Date.parse(e.selectedStartDatetime)}}},starttimePickerOptions:function(){return{disabledDate:function(e){return e.getTime()<Date.parse(new Date)}}}},methods:{getDataList:function(e,t,a){this.loading=!0,this.$http({url:this.$http.adornUrl("/sys/config/queryrange"),method:"get",params:this.$http.adornParams({start:e,end:t})}).then(function(e){var t=e.data;a(t)})},initAuthstatusCallback:function(e){if(e&&0===e.code){console.log(o()(e)),this.authstatus=[];var t=0;for(t in e.config)this.authstatus.push({value:e.config[t].paramKey,label:e.config[t].paramValue})}this.loading=!1},initServiceoptionsCallback:function(e){if(e&&0===e.code){console.log(o()(e)),this.serviceOptions=[];var t=0;for(t in e.config)this.serviceOptions.push({value:e.config[t].paramKey,label:e.config[t].paramValue})}this.loading=!1},initZabbixManagerCallback:function(e){if(e&&0===e.code){console.log(o()(e)),this.zabbixmanagers=[];var t=0;for(t in e.config)this.zabbixmanagers.push({value:e.config[t].paramKey,label:e.config[t].paramValue})}this.loading=!1},initCheckcycleOptionsCallback:function(e){if(e&&0===e.code){console.log(o()(e)),this.checkCycleOptions=[];var t=0;for(t in e.config)this.checkCycleOptions.push({value:e.config[t].paramKey,label:e.config[t].paramValue})}this.loading=!1},getCurrentProjectmngInfo:function(){var e=this;this.loading=!0,this.$http({url:this.$http.adornUrl("/sys/user/info"),method:"get",params:this.$http.adornParams()}).then(function(t){var a=t.data;console.log(a),a.user.realname?(e.viewUserShow.viewMnger=a.user.realname,e.form.headid=String(a.user.userid),console.log(e.form.headid)):(e.viewUserShow.viewMnger=a.user.username,e.form.headid=String(-a.user.userId),console.log(e.form.headid))})},closeHandle:function(){this.$refs.prodataform.resetFields(),this.$refs.zbxform.resetFields(),this.viewUserShow.viewMnger="",this.viewUserShow.viewMaintainEngeer="",this.viewUserShow.viewAmnger="",this.selectedOptions=[],this.form.address="",this.form.projectypeid="",this.form.taskid="",this.form.auditstatus="101",this.fileList=[]},init:function(e){var t=this;this.visible=!0,this.getDataList(300,310,this.initCheckcycleOptionsCallback),this.getDataList(600,699,this.initServiceoptionsCallback),this.getDataList(100,110,this.initAuthstatusCallback),this.getCurrentProjectmngInfo(),this.form.projectid=e,console.log("---+++---"),console.log(this.form.projectid),this.form.projectid?this.$http({url:this.$http.adornUrl("/fenhuo/fenhuoprojectinfo/info/"+this.form.projectid),method:"get",params:this.$http.adornParams()}).then(function(e){var a=e.data;console.log("projectinfo:------:"+o()(a)),t.form.projectname=a.projectinfo.projectname,t.form.orgname=a.projectinfo.orgname,t.form.address=a.projectinfo.address,t.$refs.cascaderAddr.presentText=a.projectinfo.province+"/"+a.projectinfo.city+"/"+a.projectinfo.county,t.form.servicedetail=a.projectinfo.serviceditemetail,t.form.servicestarttime=a.projectinfo.servicestarttime,t.form.serviceendtime=a.projectinfo.serviceendtime,t.viewUserShow.viewMnger=a.projectinfo.headname,t.viewUserShow.viewMaintainEngeer=a.projectinfo.servicemname,t.viewUserShow.viewAmnger=a.projectinfo.partyaname,t.form.projectypeid=String(a.projectinfo.projectypeid),t.form.taskid=String(a.projectinfo.taskid),t.form.auditstatus=String(a.projectinfo.auditstatus),t.form.headid=a.projectinfo.headid,t.form.servicemid=a.projectinfo.servicemid,t.form.zabbixmngid=a.projectinfo.zabbixmngid,t.form.zabbixname=a.projectinfo.zabbixname,t.form.partyaid=a.projectinfo.partyaid,a.zabbixhost.length>0&&(t.form.hostids=a.zabbixhost[0].hostids,t.form.zbxhostnames=a.zabbixhost[0].zabbixhostnames,t.form.zbxusername=a.zabbixhost[0].zbusername,t.form.zbxpassword=a.zabbixhost[0].zbuserpwd),t.handleChange(),t.projectRelatedFilelist()}):(this.form.projectname="",this.form.orgname="",this.form.address="",this.$refs.cascaderAddr.presentText="",this.selectedOptions=[],this.form.servicedetail="",this.form.servicestarttime="",this.form.serviceendtime="",this.viewUserShow.viewMnger="",this.viewUserShow.viewMaintainEngeer="",this.viewUserShow.viewAmnger="",this.form.projectypeid="",this.form.zabbixmngid="",this.form.zabbixname="",this.form.taskid="",this.form.auditstatus="",this.form.headid="",this.form.servicemid="",this.form.partyaid="",this.form.hostids="",this.form.zbxhostnames="",this.form.zbxusername="",this.form.zbxpassword="")},projectRelatedFileDownload:function(e){var t=document.createElement("a"),a=this.$http.adornUrl("/fenhuo/fenhuoprojectinfo/download?projectid="+this.form.projectid+"&token="+this.$cookie.get("token")+"&fileName="+e);t.style.display="none",t.href=a,console.log(e),t.download=e,document.body.appendChild(t),t.click(),document.body.removeChild(t)},projectRelatedFilelist:function(){var e=this;this.$http({url:this.$http.adornUrl("/fenhuo/fenhuoprojectinfo/projectfilelist/"+this.form.projectid),method:"get"}).then(function(t){var a=t.data;a&&0===a.code?(e.fileList=a.relatedfilelist,console.log(a.relatedfilelist)):e.fileList=[]})},uploadAction:function(){},uploadTest:function(){this.submitUpload(35)},dataFormSubmit:function(){var e=this;this.$refs.prodataform.validate(function(t){t&&e.$http({url:e.$http.adornUrl("/fenhuo/fenhuoprojectinfo/"+(e.form.projectid?"update":"save")),method:"post",data:e.$http.adornData({projectinfo:{projectid:e.form.projectid||void 0,projectname:e.form.projectname,orgname:e.form.orgname,address:e.form.address,province:e.form.governAddr.province,city:e.form.governAddr.city,county:e.form.governAddr.county,serviceditemetail:e.form.servicedetail,projectypeid:e.form.projectypeid,zabbixmngid:e.form.zabbixmngid,zabbixname:e.form.zabbixname,taskid:e.form.taskid,auditstatus:e.form.auditstatus,servicestarttime:e.form.servicestarttime,serviceendtime:e.form.serviceendtime,headid:e.form.headid,servicemid:e.form.servicemid,partyaid:e.form.partyaid},zabbixhost:{hostids:e.form.hostids,zabbixhostnames:e.form.zbxhostnames,zbusername:e.form.zbxusername,zbuserpwd:e.form.zbxpassword}})}).then(function(t){var a=t.data;a&&0===a.code?a.projectid&&e.submitUpload(a.projectid):e.$message.error(a.msg)})})},handleChange:function(){for(var e=["province","city","county"],t=0;t<this.selectedOptions.length;t++)this.form.governAddr[e[t]]=s.CodeToText[this.selectedOptions[t]]},disableDateTimeFunction:function(e){return e.getTime()>Date(this.selectedStartDatetime)},serviceStartDateChangeHandle:function(e){null==e||""===e?(this.form.serEnddate="",this.isAvailble=!0):(this.selectedStartDatetime=e,this.isAvailble=!1)},serviceEndDateChangeHandle:function(e){this.selectedEndDatetime=e},selectedUserHandler:function(e){2===e.usertype?(this.form.headid=String(e.userlist.id),this.viewUserShow.viewMnger=e.userlist.realname.join(",")):3===e.usertype?(this.form.servicemid=String(e.userlist.id),this.viewUserShow.viewMaintainEngeer=e.userlist.realname.join(",")):(this.form.partyaid=String(e.userlist.id),this.viewUserShow.viewAmnger=e.userlist.realname.join(",")),console.log(this.form.mnger)},selectedZabbixmngHandler:function(e){console.log(e),this.form.zabbixmngid=e.zabbixmnglist.zabbixmngid[0],this.form.zabbixname=e.zabbixmnglist.zabbixname[0],console.log("------+----")},echoZabbix:function(){this.$http({url:this.$http.adornUrl("/fenhuo/fenhuozabbixhost/authAndgethosts"),method:"post",params:this.$http.adornParams({zbxUsername:this.form.zbxusername,zbxPassword:this.form.zbxpassword})}).then(function(e){var t=e.data;t&&0===t.code&&(console.log(t),console.log("!!!!!!!!!!!!!!"))})},modifyAccount:function(){var e=this;this.$http({url:this.$http.adornUrl("/fenhuo/fenhuozabbixhost/authAndgethosts"),method:"post",params:this.$http.adornParams({zbxUsername:this.form.modifyzbxusername,zbxPassword:this.form.modifyzbxpassword})}).then(function(t){var a=t.data;a&&0===a.code?(console.log(a),console.log("!!!!!!!!!!!!!!"),e.form.zbxusername=e.form.modifyzbxusername,e.form.zbxpassword=e.form.modifyzbxpassword,e.modifyAccountVisible=!1):e.$message.error("zabbix服务器用户名或者密码错误")})},handlePreview:function(e){console.log("handlePreview:"+e)},handleRemove:function(e,t){console.log("handleRemove file: "+o()(e)+"!!--!!fileList: "+o()(t))},onUploadStatuChange:function(e,t){this.fileList=t,console.log("onUploadStatuChange file: "+o()(e)+"!!--!!fileList: "+o()(t))},deleteFileHandler:function(e,t){var a=void 0;for(a in this.fileList){var i=this.fileList[a];if(console.log("fileJson:"+o()(this.fileList[a])+",file uid:"+i.uid+", delUid:"+e),i.uid===e){this.form.projectid&&"success"===i.status&&this.delfileIds.push(i.fileid);break}}a>-1&&this.fileList.splice(a,1),console.log("deleted filelist:"+o()(this.fileList))},uploadfile:function(e){console.log(e),this.uploadformdata.append("files",e.file)},submitUpload:function(e){var t=this;this.uploadformdata=new FormData,this.$refs.upload.submit(),e?this.uploadformdata.append("deleteFiles",this.delfileIds):this.uploadformdata.append("deleteFiles",[]);var a=this,i={headers:{"Content-Type":"multipart/form-data"},onUploadProgress:function(e){e.lengthComputable&&(a.uploadRate=100*(e.loaded/e.total).toFixed(2))}};this.isUploadOk=!1,this.isUploading=!0,d.a.post(this.$http.adornUrl("/fenhuo/fenhuoprojectinfo/upload/"+e+"?token="+this.$cookie.get("token")),this.uploadformdata,i).then(function(e){t.isUploadOk=!0,t.$message({message:"操作成功",type:"success",duration:1500,onClose:function(){t.$refs.prodataform.resetFields(),t.visible=!1,t.$emit("refreshDataList")}}),t.fileList=[],console.log(e)}).catch(function(e){console.log(e)})},uploadSuccess:function(e,t,a){console.log("-----------------------uploadSuccess-------------"),console.log("response:"+o()(e)),console.log("file:"+o()(t)),console.log("fileList:"+o()(a))},handleClick:function(e,t){console.log(e,t)}}},h={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-dialog",{attrs:{title:"项目创建","close-on-click-modal":!1,visible:e.visible,"v-loading":e.loading,width:"80%"},on:{close:e.closeHandle,"update:visible":function(t){e.visible=t}}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-card",{attrs:{shadow:"always"}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("h2",[e._v("项目信息")])]),e._v(" "),a("el-form",{ref:"prodataform",attrs:{model:e.form,"label-width":"80px",rules:e.dataRule}},[a("el-form-item",{attrs:{label:"项目名称",prop:"projectname"}},[a("el-input",{model:{value:e.form.projectname,callback:function(t){e.$set(e.form,"projectname",t)},expression:"form.projectname"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"单位名称",prop:"orgname"}},[a("el-input",{model:{value:e.form.orgname,callback:function(t){e.$set(e.form,"orgname",t)},expression:"form.orgname"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"详细地址",prop:"detailAddr"}},[a("el-cascader",{ref:"cascaderAddr",staticStyle:{width:"100%"},attrs:{size:"large",options:e.options},on:{change:e.handleChange},model:{value:e.selectedOptions,callback:function(t){e.selectedOptions=t},expression:"selectedOptions"}}),e._v(" "),a("el-input",{model:{value:e.form.address,callback:function(t){e.$set(e.form,"address",t)},expression:"form.address"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"服务内容",prop:"servicedetail"}},[a("el-input",{model:{value:e.form.servicedetail,callback:function(t){e.$set(e.form,"servicedetail",t)},expression:"form.servicedetail"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"服务类型",prop:"serviceType"}},[a("el-select",{ref:"serviceType",staticStyle:{width:"100%"},attrs:{placeholder:"请选择"},model:{value:e.form.projectypeid,callback:function(t){e.$set(e.form,"projectypeid",t)},expression:"form.projectypeid"}},e._l(e.serviceOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1),e._v(" "),a("el-form-item",{attrs:{label:"zabbix服务器",prop:"zabbixmngid"}},[a("selectZabbixmngView",{attrs:{tabelTitle:"选择zabbix服务器主机"},on:{selectedAction:e.selectedZabbixmngHandler}},[a("el-input",{attrs:{disabled:""},model:{value:e.form.zabbixname,callback:function(t){e.$set(e.form,"zabbixname",t)},expression:"form.zabbixname"}})],1)],1),e._v(" "),a("el-row",[a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"巡检",prop:"checkTask"}},[a("el-select",{ref:"taskcheck",attrs:{placeholder:"请选择"},model:{value:e.form.taskid,callback:function(t){e.$set(e.form,"taskid",t)},expression:"form.taskid"}},e._l(e.checkCycleOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-form-item",{attrs:{label:"项目状态",prop:"autistatus"}},[a("el-select",{ref:"auditStatus",staticStyle:{width:"100%"},attrs:{disabled:"",placeholder:"请选择"},model:{value:e.form.auditstatus,callback:function(t){e.$set(e.form,"auditstatus",t)},expression:"form.auditstatus"}},e._l(e.authstatus,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1)],1),e._v(" "),a("el-form-item",{attrs:{label:"服务开始",prop:"servicestarttime"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss","picker-options":e.starttimePickerOptions},on:{change:e.serviceStartDateChangeHandle},model:{value:e.form.servicestarttime,callback:function(t){e.$set(e.form,"servicestarttime",t)},expression:"form.servicestarttime"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"服务结束",prop:"serviceendtime"}},[a("el-date-picker",{staticStyle:{width:"100%"},attrs:{type:"datetime","value-format":"yyyy-MM-dd HH:mm:ss","picker-options":e.endtimePickerOptions,disabled:e.isAvailble},on:{change:e.serviceEndDateChangeHandle},model:{value:e.form.serviceendtime,callback:function(t){e.$set(e.form,"serviceendtime",t)},expression:"form.serviceendtime"}})],1)],1),e._v(" "),a("el-form",{ref:"projRelatedPersons",attrs:{"label-position":"top",width:"80%"}},[a("el-form-item",{staticStyle:{margin:"0"},attrs:{label:"项目负责人",prop:"viewMnger"}},[a("el-row",{attrs:{gutter:15}},[a("el-col",{attrs:{span:20}},[a("el-input",{attrs:{disabled:""},model:{value:e.viewUserShow.viewMnger,callback:function(t){e.$set(e.viewUserShow,"viewMnger",t)},expression:"viewUserShow.viewMnger"}})],1),e._v(" "),a("el-col",{attrs:{span:4}},[a("selectView",{attrs:{tabelTitle:"选择项目负责人",choiceUserType:2},on:{selectedAction:e.selectedUserHandler}},[a("el-button",{attrs:{type:"primary"}},[e._v("选择")])],1)],1)],1)],1),e._v(" "),a("el-form-item",{staticStyle:{margin:"0"},attrs:{label:"维护工程师",prop:"viewMaintainEngeer"}},[a("el-row",{attrs:{gutter:15}},[a("el-col",{attrs:{span:20}},[a("el-input",{attrs:{disabled:""},model:{value:e.viewUserShow.viewMaintainEngeer,callback:function(t){e.$set(e.viewUserShow,"viewMaintainEngeer",t)},expression:"viewUserShow.viewMaintainEngeer"}})],1),e._v(" "),a("el-col",{attrs:{span:4}},[a("selectView",{attrs:{tabelTitle:"选择维护工程师",choiceUserType:3},on:{selectedAction:e.selectedUserHandler}},[a("el-button",{attrs:{type:"primary"}},[e._v("选择")])],1)],1)],1)],1),e._v(" "),a("el-form-item",{staticStyle:{margin:"0"},attrs:{label:"甲方负责人",prop:"viewAmnger"}},[a("el-row",{attrs:{gutter:15}},[a("el-col",{attrs:{span:20}},[a("el-input",{attrs:{disabled:""},model:{value:e.viewUserShow.viewAmnger,callback:function(t){e.$set(e.viewUserShow,"viewAmnger",t)},expression:"viewUserShow.viewAmnger"}})],1),e._v(" "),a("el-col",{attrs:{span:4}},[a("selectView",{attrs:{tabelTitle:"选择甲方负责人",choiceUserType:1},on:{selectedAction:e.selectedUserHandler}},[a("el-button",{attrs:{type:"primary"}},[e._v("选择")])],1)],1)],1)],1)],1)],1)],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-card",{directives:[{name:"show",rawName:"v-show",value:600==e.form.projectypeid,expression:"form.projectypeid == 600? true: false"}],attrs:{shadow:"always"}},[a("div",{attrs:{slot:"header"},slot:"header"},[a("h2",[e._v("运维监控")])]),e._v(" "),a("el-tabs",{on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{staticStyle:{height:"174px","overflow-y":"auto","overflow-x":"hidden"},attrs:{label:"账号管理",name:"first"}},[a("el-form",{ref:"zbxform",attrs:{model:e.form,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"用户名",prop:"zbxusername"}},[a("el-input",{attrs:{disabled:""},model:{value:e.form.zbxusername,callback:function(t){e.$set(e.form,"zbxusername",t)},expression:"form.zbxusername"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"密码",prop:"zbxpassword"}},[a("el-input",{attrs:{type:"password",autocomplete:"off",disabled:""},model:{value:e.form.zbxpassword,callback:function(t){e.$set(e.form,"zbxpassword",t)},expression:"form.zbxpassword"}})],1),e._v(" "),a("el-form-item",[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.modifyAccountVisible=!0}}},[e._v("编辑账户")])],1)],1)],1)],1)],1),e._v(" "),a("el-card",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("el-container",[a("span",[a("h2",{staticStyle:{"line-height":"0px"}},[e._v("项目附件")])])])],1),e._v(" "),a("el-col",{attrs:{span:6,offset:12}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"#","on-preview":e.handlePreview,"on-change":e.onUploadStatuChange,multiple:"","on-remove":e.handleRemove,"on-success":e.uploadSuccess,"file-list":e.fileList,"show-file-list":!1,"auto-upload":!1,"http-request":e.uploadfile}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary",disabled:e.isUploading},slot:"trigger"},[e._v("添加附件")])],1)],1)],1),e._v(" "),a("el-divider"),e._v(" "),a("ul",{staticClass:"infinite-list",staticStyle:{overflow:"auto"}},e._l(e.fileList,function(t){return a("el-row",{key:t.uid},[a("li",{staticClass:"infinite-list-item"},[a("el-col",{attrs:{span:8,offset:1}},[a("h3",[e._v(e._s(t.name))])]),e._v(" "),a("el-col",{attrs:{span:5,offset:10}},[e.form.projectid?a("el-link",{attrs:{type:"primary",underline:!1},on:{click:function(a){e.projectRelatedFileDownload(t.name)}}},[e._v("下载")]):e._e(),e._v(" "),a("el-link",{attrs:{type:"primary",underline:!1},on:{click:function(a){e.deleteFileHandler(t.uid,t.name)}}},[e._v("删除")])],1)],1)])})),e._v(" "),a("el-progress",{directives:[{name:"show",rawName:"v-show",value:e.isUploading,expression:"isUploading"}],attrs:{"text-inside":!0,"stroke-width":20,percentage:e.uploadRate}})],1)],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{disabled:e.isUploading},on:{click:function(t){e.visible=!1}}},[e._v("取消")]),e._v(" "),a("el-button",{attrs:{type:"primary",disabled:e.isUploading},on:{click:function(t){e.dataFormSubmit()}}},[e._v("确定")])],1),e._v(" "),a("el-dialog",{attrs:{title:"修改zabbix账户",visible:e.modifyAccountVisible,width:"30%","append-to-body":""},on:{"update:visible":function(t){e.modifyAccountVisible=t}}},[a("el-form",{ref:"zbxformmodify",attrs:{model:e.form,"label-width":"100px"}},[a("el-form-item",{attrs:{label:"用户名",prop:"modifyzbxusername"}},[a("el-input",{model:{value:e.form.modifyzbxusername,callback:function(t){e.$set(e.form,"modifyzbxusername",t)},expression:"form.modifyzbxusername"}})],1),e._v(" "),a("el-form-item",{attrs:{label:"密码",prop:"modifyzbxpassword"}},[a("el-input",{attrs:{type:"password",autocomplete:"off"},model:{value:e.form.modifyzbxpassword,callback:function(t){e.$set(e.form,"modifyzbxpassword",t)},expression:"form.modifyzbxpassword"}})],1)],1),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{on:{click:function(t){e.modifyAccountVisible=!1}}},[e._v("取 消")]),e._v(" "),a("el-button",{attrs:{type:"primary"},on:{click:e.modifyAccount}},[e._v("确 定")])],1)],1)],1)},staticRenderFns:[]};var p=a("46Yf")(c,h,!1,function(e){a("errT")},"data-v-be51f5e8",null);t.default=p.exports},IZqZ:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("3cXf"),o=a.n(i),s={data:function(){return{searchData:{dateRange:"",catalogid:"",projectname:"",catalogOptions:[]},searchVisible:!1}},methods:{init:function(){this.searchVisible=!0,this.getDataList(600,699,this.catalogOptionsCallback)},getDataList:function(e,t,a){this.loading=!0,this.$http({url:this.$http.adornUrl("/sys/config/queryrange"),method:"get",params:this.$http.adornParams({start:e,end:t})}).then(function(e){var t=e.data;a(t)})},catalogOptionsCallback:function(e){if(e&&0===e.code){console.log(o()(e)),this.searchData.catalogOptions=[];var t=0;for(t in e.config)this.searchData.catalogOptions.push({value:e.config[t].paramKey,label:e.config[t].paramValue})}this.loading=!1},destory:function(){this.searchData.dateRange="",this.searchData.catalogid="",this.searchData.projectname="",this.searchData.catalogOptions=[],this.searchVisible=!1},valueChangeHandle:function(e){console.log(this.searchData),this.$emit("searchAction",this.searchData)}}},n={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return e.searchVisible?a("el-form",{attrs:{"label-width":"80px"}},[a("el-row",[a("el-col",{attrs:{span:8}},[a("el-form-item",{staticStyle:{margin:"5px 0px"},attrs:{label:"创建日期"}},[a("el-date-picker",{attrs:{type:"daterange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd"},on:{change:e.valueChangeHandle},model:{value:e.searchData.dateRange,callback:function(t){e.$set(e.searchData,"dateRange",t)},expression:"searchData.dateRange"}})],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{staticStyle:{margin:"5px 0px"},attrs:{label:"项目类别"}},[a("el-select",{staticStyle:{width:"100%"},attrs:{placeholder:"请选择项目类别"},on:{change:e.valueChangeHandle},model:{value:e.searchData.catalogid,callback:function(t){e.$set(e.searchData,"catalogid",t)},expression:"searchData.catalogid"}},e._l(e.searchData.catalogOptions,function(e){return a("el-option",{key:e.value,attrs:{label:e.label,value:e.value}})}))],1)],1),e._v(" "),a("el-col",{attrs:{span:6}},[a("el-form-item",{staticStyle:{margin:"5px 0px"},attrs:{label:"项目名称"}},[a("el-input",{attrs:{placeholder:"请输入内容",clearable:""},on:{change:e.valueChangeHandle},model:{value:e.searchData.projectname,callback:function(t){e.$set(e.searchData,"projectname",t)},expression:"searchData.projectname"}})],1)],1)],1),e._v(" "),a("el-row")],1):e._e()},staticRenderFns:[]},r=a("46Yf")(s,n,!1,null,null,null);t.default=r.exports},S3gW:function(e,t,a){(e.exports=a("acE3")(!1)).push([e.i,"\n.infinite-list[data-v-be51f5e8] {\r\n  list-style: none;\n}\n.infinite-list .infinite-list-item[data-v-be51f5e8] {\r\n  display: -webkit-box;\r\n  display: -ms-flexbox;\r\n  display: flex;\r\n  -webkit-box-align: center;\r\n      -ms-flex-align: center;\r\n          align-items: center;\r\n  -webkit-box-pack: center;\r\n      -ms-flex-pack: center;\r\n          justify-content: center;\r\n  height: 50px;\r\n  background: #f1f1f1;\r\n  color: #1b1919;\r\n  margin: 10px 0px;\r\n  border-bottom: black;\r\n  border-bottom-width: thin;\r\n  border-bottom-style: solid;\n}\r\n",""])},"SX+T":function(e,t,a){(e.exports=a("acE3")(!1)).push([e.i,"\n.projectactive[data-v-0195ed92] {\n  color:green\n}\n.projectinactive[data-v-0195ed92] {\n  color: red\n}\n",""])},TskF:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("3cXf"),o=a.n(i),s=a("lm2O"),n=a.n(s),r=a("IZqZ"),l=a("0Eql"),d=a("kvhC"),c={data:function(){return{foundCount:0,selectedCount:0,dataForm:{key:""},viewVisible:!1,dataList:[],pageIndex:1,pageSize:10,totalPage:0,dataListLoading:!1,dataListSelections:[],zbxdatainfo:[],selectedprojectid:"",tabelTitle:"项目信息",inactive:!1,searchViewVisible:!1}},components:{searchView:r.default,addOrUpdateView:l.default,showProInfoView:d.default},created:function(){this.getDataList()},computed:{isapplyforactivebtnenable:function(){var e=void 0;for(e in this.dataListSelections)if(106===this.dataListSelections[e].auditstatus)return!0;return!1},isapplyforclosebtnenable:function(){var e=void 0;for(e in this.dataListSelections)if(104===this.dataListSelections[e].auditstatus)return!0;return!1},isActiveButtonEnable:function(){var e=void 0;for(e in this.dataListSelections)if(104===this.dataListSelections[e].auditstatus)return!1;return!0},isCloseButtonEnable:function(){var e=void 0;for(e in this.dataListSelections){if(106===this.dataListSelections[e].auditstatus)return!1;if(101===this.dataListSelections[e].auditstatus)return!1;if(102===this.dataListSelections[e].auditstatus)return!1}return!0},isAuditButtonEnable:function(){var e=void 0;for(e in this.dataListSelections)if(101===this.dataListSelections[e].auditstatus)return!0;return!1}},methods:{getDataList:function(e){var t=this;this.dataListLoading=!0,this.$http({url:this.$http.adornUrl("/fenhuo/fenhuoprojectinfo/list"),method:"get",params:this.$http.adornParams(n()({page:this.pageIndex,limit:this.pageSize,key:this.dataForm.key},e))}).then(function(e){var a=e.data;a&&0===a.code?(t.dataList=a.page.list,t.totalPage=a.page.totalCount,t.foundCount=t.dataList.length):(t.dataList=[],t.totalPage=0,t.foundCount=0),t.dataListLoading=!1,t.viewVisible=!1})},deleteHandle:function(e){var t=this;console.log("this.dataListSelections"+o()(this.dataListSelections));var a=e?[e]:this.dataListSelections.map(function(e){return e.projectid});this.$confirm("确定对[id="+a.join(",")+"]进行["+(1===a.length?"删除":"批量删除")+"]操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){t.$http({url:t.$http.adornUrl("/fenhuo/fenhuoprojectinfo/delete"),method:"post",data:t.$http.adornData(a,!1)}).then(function(e){var a=e.data;a&&0===a.code?t.$message({message:"操作成功",type:"success",duration:1500,onClose:function(){t.getDataList()}}):t.$message.error(a.msg)})}).catch(function(){})},applyforactiveHandle:function(e){var t,a=this;console.log("paramProjectId:",e),this.dataListSelections.length<=0&&e?(this.dataListSelections.push(e),t=this.dataListSelections):t=this.dataListSelections.map(function(e){return e.projectid}),this.$confirm("确定对[id="+t.join(",")+"]进行["+(1===t.length?"申请激活":"批量申请激活")+"]操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.$http({url:a.$http.adornUrl("/fenhuo/fenhuoprojectinfo/applyfor/active"),method:"post",data:a.$http.adornData(t,!1)}).then(function(e){var t=e.data;t&&0===t.code?a.$message({message:"操作成功",type:"success",duration:1500,onClose:function(){a.getDataList()}}):a.$message.error(t.msg)})}).catch(function(){})},applyforcloseHandle:function(e){var t,a=this;console.log("paramProjectId:",e),this.dataListSelections.length<=0&&e?(this.dataListSelections.push(e),t=this.dataListSelections):t=this.dataListSelections.map(function(e){return e.projectid}),this.$confirm("确定对[id="+t.join(",")+"]进行["+(1===t.length?"申请关闭":"批量申请关闭")+"]操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){a.$http({url:a.$http.adornUrl("/fenhuo/fenhuoprojectinfo/applyfor/close"),method:"post",data:a.$http.adornData(t,!1)}).then(function(e){var t=e.data;t&&0===t.code?a.$message({message:"操作成功",type:"success",duration:1500,onClose:function(){a.getDataList()}}):a.$message.error(t.msg)})}).catch(function(){})},enableProject:function(){var e=this;console.log("this.dataListSelections"+o()(this.dataListSelections));var t=this.dataListSelections.map(function(e){return e.projectid});this.$confirm("确定对[id="+t.join(",")+"]进行["+(1===t.length?"激活":"批量激活")+"]操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$http({url:e.$http.adornUrl("/fenhuo/fenhuoprojectinfo/active"),method:"post",data:e.$http.adornData(t,!1)}).then(function(t){var a=t.data;a&&0===a.code?e.$message({message:"操作成功",type:"success",duration:1500,onClose:function(){e.getDataList()}}):e.$message.error(a.msg)})}).catch(function(){})},failedAudit:function(){var e=this;console.log("this.dataListSelections"+o()(this.dataListSelections));var t=this.dataListSelections.map(function(e){return e.projectid});this.$confirm("确定对[id="+t.join(",")+"]进行["+(1===t.length?"未通过":"批量未通过")+"]操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$http({url:e.$http.adornUrl("/fenhuo/fenhuoprojectinfo/faildaudit"),method:"post",data:e.$http.adornData(t,!1)}).then(function(t){var a=t.data;a&&0===a.code?e.$message({message:"操作成功",type:"success",duration:1500,onClose:function(){e.getDataList()}}):e.$message.error(a.msg)})}).catch(function(){})},closeProject:function(){var e=this;console.log("this.dataListSelections"+o()(this.dataListSelections));var t=this.dataListSelections.map(function(e){return e.projectid});this.$confirm("确定对[id="+t.join(",")+"]进行["+(1===t.length?"关闭":"批量关闭")+"]操作?","提示",{confirmButtonText:"确定",cancelButtonText:"取消",type:"warning"}).then(function(){e.$http({url:e.$http.adornUrl("/fenhuo/fenhuoprojectinfo/close"),method:"post",data:e.$http.adornData(t,!1)}).then(function(t){var a=t.data;a&&0===a.code?e.$message({message:"操作成功",type:"success",duration:1500,onClose:function(){e.getDataList()}}):e.$message.error(a.msg)})}).catch(function(){})},getZbxinfoAndshowView:function(e){this.selectedprojectid=e},selectionChangeHandle:function(e){this.dataListSelections=e,this.selectedCount=this.dataListSelections.length},addOrUpdateHandle:function(e){var t=this;this.viewVisible=!0,this.$nextTick(function(){t.$refs.addupdateView.init(e)})},sizeChangeHandle:function(e){this.pageSize=e,this.pageIndex=1,this.getDataList()},currentChangeHandle:function(e){this.pageIndex=e,this.getDataList()},toggleSearchView:function(){var e=this;this.searchViewVisible?(this.$nextTick(function(){e.$refs.searchView.destory()}),this.searchViewVisible=!1,this.getDataList(null)):(this.searchViewVisible=!0,this.$nextTick(function(){e.$refs.searchView.init()}))},skillfileSearchHandle:function(e){var t={startDate:e.dateRange?e.dateRange[0]:"",endDate:e.dateRange?e.dateRange[1]:"",projectype:e.catalogid,projectname:e.projectname};this.getDataList(t)}}},h={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("div",{staticClass:"mod-log"},[a("el-tag",{attrs:{effect:"plain",type:"info"}},[e._v("共搜索到"+e._s(e.foundCount)+"条数据")]),e._v(" "),a("el-form",{attrs:{inline:!0,model:e.dataForm},nativeOn:{keyup:function(t){if(!("button"in t)&&e._k(t.keyCode,"enter",13,t.key,"Enter"))return null;e.getDataList()}}},[a("el-form-item",[e.isAuth("fenhuo:proj:save")?a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){e.addOrUpdateHandle()}}},[e._v("新建项目")]):e._e()],1),e._v(" "),a("el-form-item",[e.isAuth("fenhuo:proj:delete")?a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){e.deleteHandle()}}},[e._v("删除项目")]):e._e()],1),e._v(" "),a("el-form-item",[e.isAuth("fenhuo:proj:active")?a("el-button",{attrs:{type:"primary",plain:"",disabled:!e.isActiveButtonEnable},on:{click:function(t){e.enableProject()}}},[e._v("激活项目")]):e._e()],1),e._v(" "),a("el-form-item",[e.isAuth("fenhuo:proj:auth")?a("el-button",{attrs:{type:"primary",plain:"",disabled:!e.isAuditButtonEnable},on:{click:function(t){e.failedAudit()}}},[e._v("未审批通过")]):e._e()],1),e._v(" "),a("el-form-item",[e.isAuth("fenhuo:proj:close")?a("el-button",{attrs:{type:"primary",plain:"",disabled:!e.isCloseButtonEnable},on:{click:function(t){e.closeProject()}}},[e._v("关闭项目")]):e._e()],1),e._v(" "),a("el-form-item",[e.isAuth("fenhuo:skillfile:search")?a("el-button",{attrs:{type:"primary",plain:""},on:{click:function(t){e.toggleSearchView()}}},[e._v("高级搜索")]):e._e()],1),e._v(" "),e.searchViewVisible?a("searchView",{ref:"searchView",on:{searchAction:e.skillfileSearchHandle}}):e._e()],1),e._v(" "),a("el-alert",{attrs:{type:"info","show-icon":""}},[e._v("已选择"+e._s(e.selectedCount)+"项")]),e._v(" "),a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.dataListLoading,expression:"dataListLoading"}],staticStyle:{width:"100%"},attrs:{data:e.dataList,border:"",stripe:""},on:{"selection-change":e.selectionChangeHandle}},[a("el-table-column",{attrs:{fixed:"",type:"selection",width:"40"}}),e._v(" "),a("el-table-column",{attrs:{prop:"projectcreatetime","header-align":"center",align:"center",width:"160",label:"项目创建时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"projectype","header-align":"center",align:"center",width:"160",label:"项目类型"}}),e._v(" "),a("el-table-column",{attrs:{prop:"projectname","header-align":"center",align:"center",width:"180",label:"项目名称"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("showProInfoView",{attrs:{inactive:1!==t.row.isactive,tabelTitle:e.tabelTitle,zbxdatainfo:e.zbxdatainfo,projectid:t.row.projectid,projtypeid:t.row.projectypeid,orgname:t.row.orgname,address:t.row.address,servicedetail:t.row.serviceditemetail,effectivetime:t.row.effectivetime,taskname:t.row.taskname,zabbixname:t.row.zabbixname}},[a("span",{on:{click:function(a){e.getZbxinfoAndshowView(t.row.projectid)}}},[e._v(e._s(t.row.projectname))])])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"auditname","header-align":"center",align:"center",width:"110","show-overflow-tooltip":!0,label:"项目状态"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("span",{class:{projectactive:1===t.row.isactive,projectinactive:0===t.row.isactive}},[e._v(e._s(t.row.auditname))])]}}])}),e._v(" "),a("el-table-column",{attrs:{prop:"headname","header-align":"center",align:"center",width:"150","show-overflow-tooltip":!0,label:"项目负责人"}}),e._v(" "),a("el-table-column",{attrs:{prop:"params","header-align":"center",align:"center",width:"250","show-overflow-tooltip":!0,label:"负责人变更记录"}}),e._v(" "),a("el-table-column",{attrs:{prop:"servicestarttime","header-align":"center",align:"center",width:"160","show-overflow-tooltip":!0,label:"服务开始时间"}}),e._v(" "),a("el-table-column",{attrs:{prop:"serviceendtime","header-align":"center",align:"center",width:"160","show-overflow-tooltip":!0,label:"服务结束时间"}}),e._v(" "),e.isAuth("fenhuo:fenhuoprojectinfo:update")?a("el-table-column",{attrs:{fixed:"right","header-align":"center",align:"center",width:"150",label:"操作"},scopedSlots:e._u([{key:"default",fn:function(t){return[a("el-button",{attrs:{type:"text",size:"small",disabled:101!=t.row.auditstatus&&106!=t.row.auditstatus&&102!=t.row.auditstatus},on:{click:function(a){e.addOrUpdateHandle(t.row.projectid)}}},[e._v("修改")]),e._v(" "),!e.isAuth("fenhuo:proj:applyfor")||101!==t.row.auditstatus&&102!==t.row.auditstatus&&106!==t.row.auditstatus?e.isAuth("fenhuo:proj:applyfor")&&104===t.row.auditstatus?a("el-button",{attrs:{type:"text"},on:{click:function(a){e.applyforcloseHandle(t.row.projectid)}}},[e._v("申请关闭")]):103===t.row.auditstatus?a("el-button",{attrs:{type:"text"}},[e._v("申请激活中")]):105===t.row.auditstatus?a("el-button",{attrs:{type:"text"}},[e._v("申请关闭中")]):e._e():a("el-button",{attrs:{type:"text"},on:{click:function(a){e.applyforactiveHandle(t.row.projectid)}}},[e._v("申请激活")])]}}])}):e._e()],1),e._v(" "),a("el-pagination",{attrs:{"current-page":e.pageIndex,"page-sizes":[10,20,50,100],"page-size":e.pageSize,total:e.totalPage,layout:"total, sizes, prev, pager, next, jumper"},on:{"size-change":e.sizeChangeHandle,"current-change":e.currentChangeHandle}}),e._v(" "),e.viewVisible?a("addOrUpdateView",{ref:"addupdateView",on:{refreshDataList:e.getDataList}}):e._e()],1)},staticRenderFns:[]};var p=a("46Yf")(c,h,!1,function(e){a("h9YM")},"data-v-0195ed92",null);t.default=p.exports},WNmw:function(e,t,a){var i=a("fnYB");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a("XkoO")("4615f014",i,!0)},errT:function(e,t,a){var i=a("S3gW");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a("XkoO")("4b327bf8",i,!0)},fnYB:function(e,t,a){(e.exports=a("acE3")(!1)).push([e.i,"\n.mod-demo-echarts > .el-alert {\n  margin-bottom: 10px;\n}\n.mod-demo-echarts > .el-row {\n  margin-top: -10px;\n  margin-bottom: -10px;\n}\n.mod-demo-echarts > .el-row .el-col {\n    padding-top: 10px;\n    padding-bottom: 10px;\n}\n.mod-demo-echarts .chart-box {\n  min-height: 200px;\n}\n.infinite-list {\n  list-style: none;\n}\n.infinite-list .infinite-list-item {\n  display: -webkit-box;\n  display: -ms-flexbox;\n  display: flex;\n  -webkit-box-align: center;\n      -ms-flex-align: center;\n          align-items: center;\n  -webkit-box-pack: center;\n      -ms-flex-pack: center;\n          justify-content: center;\n  height: 50px;\n  background: #f1f1f1;\n  color: #1b1919;\n  margin: 10px 0px;\n  border-bottom: black;\n  border-bottom-width: thin;\n  border-bottom-style: solid;\n}\n",""])},h9YM:function(e,t,a){var i=a("SX+T");"string"==typeof i&&(i=[[e.i,i,""]]),i.locals&&(e.exports=i.locals);a("XkoO")("614665ba",i,!0)},kvhC:function(e,t,a){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var i=a("3cXf"),o=a.n(i),s=a("Pg0u"),n=a.n(s),r=a("I29D"),l=a.n(r),d={props:["inactive","tabelTitle","projectid","projtypeid","orgname","address","servicedetail","effectivetime","taskname","zabbixname"],data:function(){return{loadingcss:{text:"loading",color:"#c23531",textColor:"#000",maskColor:"rgba(255, 255, 255, 0.2)",zlevel:0},chartCpuLine:null,pieOption:{backgroundColor:"#2c343c",title:{text:"Customized Pie",left:"center",top:20,textStyle:{color:"#ccc"}},tooltip:{trigger:"item",formatter:"{a} <br/>{b} : {c} ({d}%)"},visualMap:{show:!1,min:80,max:600,inRange:{colorLightness:[0,1]}},series:[{name:"访问来源",type:"pie",radius:"55%",center:["50%","50%"],data:[{value:335,name:"直接访问"},{value:310,name:"邮件营销"},{value:274,name:"联盟广告"},{value:400,name:"视频广告"},{value:400,name:"搜索引擎"}].sort(function(e,t){return e.value-t.value}),roseType:"radius",label:{normal:{textStyle:{color:"rgba(255, 255, 255, 0.3)"}}},labelLine:{normal:{lineStyle:{color:"rgba(255, 255, 255, 0.3)"},smooth:.2,length:10,length2:20}},itemStyle:{normal:{color:"#c23531",shadowBlur:200,shadowColor:"rgba(0, 0, 0, 0.5)"}},animationType:"scale",animationEasing:"elasticOut",animationDelay:function(e){return 200*Math.random()}}]},cpulineOption:{title:{text:""},tooltip:{trigger:"axis"},legend:{data:[]},grid:{left:"3%",right:"4%",bottom:"3%",containLabel:!0},toolbox:{feature:{saveAsImage:{}}},xAxis:{axisLabel:{interval:0,rotate:40},type:"time",boundaryGap:!1},yAxis:{min:0,max:1e3},series:[]},activeName:"first",collapseActiveName:["1","2"],tabinited:{first:!1,second:!1},mngerTbHeads:[{id:"0",propname:"realname",labelname:"真实姓名",widthvalue:"120"},{id:"1",propname:"realname",labelname:"联系人",widthvalue:"120"},{id:"2",propname:"mobile",labelname:"联系方式",widthvalue:"120"}],mainTainTbHeads:[{id:"0",propname:"realname",labelname:"真实姓名",widthvalue:"120"},{id:"1",propname:"realname",labelname:"联系人",widthvalue:"120"},{id:"2",propname:"mobile",labelname:"联系方式",widthvalue:"120"}],AmngeTbHeads:[{id:"0",propname:"realname",labelname:"真实姓名",widthvalue:"120"},{id:"1",propname:"realname",labelname:"联系人",widthvalue:"120"},{id:"2",propname:"mobile",labelname:"联系方式",widthvalue:"120"}],fullscreenLoading:!1,dataListLoading:{mngloading:!1,Amngloading:!1,maintainloading:!0},dataList:{mng:[],Amng:[],maintain:[]},fileList:[],showMathod:"click",zbxhosts:[],selectedhostname:"",zbxitems:[],selectedItemname:"",selectedHostid:"",selectedItemid:"",zbxAuthKey:"",zbxAuthId:"",datepickenabled:!0,dateTimeRange:"",delfileIds:[]}},methods:{init:function(){},popshowinit:function(){this.dataListLoading.Amngloading=!0,this.dataListLoading.mngloading=!0,this.dataListLoading.maintainloading=!1,this.getDataList({roleid:1}),this.getDataList({roleid:2}),this.getDataList({roleid:3}),this.projectRelatedFilelist(),this.getZbxhostsMessageByProjectid()},showChartline:function(){console.log("popover show:",this.projectid),this.$nextTick(function(){})},hideHandler:function(){this.tabinited.first=!1,this.tabinited.second=!1},projectRelatedFileDownload:function(e,t){window.location.href=this.$http.adornUrl("/doc/proj_"+e+"/"+t)},projectRelatedFilelist:function(){var e=this;this.$http({url:this.$http.adornUrl("/fenhuo/fenhuoprojectinfo/projectfilelist/"+this.projectid),method:"get"}).then(function(t){var a=t.data;a&&0===a.code?(e.fileList=a.relatedfilelist,e.fullscreenLoading=!1):e.fileList=[]})},showProjectRelateduser:function(){},getDataList:function(e){var t=this;this.$http({url:this.$http.adornUrl("/fenhuo/fenhuousers/projectlist/"+this.projectid),method:"post",params:this.$http.adornParams(e)}).then(function(a){var i=a.data;i&&0===i.code?(1===e.roleid?(t.dataList.Amng=i.userlist,t.dataListLoading.Amngloading=!1):2===e.roleid?(t.dataList.mng=i.userlist,t.dataListLoading.mngloading=!1):(t.dataList.maintain=i.userlist,t.dataListLoading.maintainloading=!1),console.log(i)):console.log(i)})},initCPUChartLine:function(){var e=this;this.chartCpuLine=n.a.init(this.$refs.J_chartCPULineBox),this.chartCpuLine.showLoading(this.loadingcss),this.$http({url:this.$http.adornUrl("/fenhuo/fenhuozabbixhost/zbxhostiteminfo"),method:"post",params:this.$http.adornParams({itemid:this.selectedItemid,auth:this.zbxAuthKey,id:this.zbxAuthId,from:this.from,till:this.till})}).then(function(t){var a=t.data;if(console.log(a),0===a.code){console.log(a.history),e.cpulineOption.series=[];var i=[],o=[];a.history.result.forEach(function(t){i.push([1e3*parseInt(t.clock),100*parseFloat(t.value)]),o.push(t.value),e.cpulineOption.legend.data.push(e.selectedhostname)});var s=Math.max(o),n=Math.min(o),r={name:e.selectedhostname,type:"line",data:i};e.cpulineOption.yAxis.min=n,e.cpulineOption.yAxis.max=s,e.cpulineOption.title.text=e.selectedItemname,e.cpulineOption.series.push(r)}console.log(a),e.chartCpuLine.hideLoading(),e.chartCpuLine.setOption(e.cpulineOption),e.chartCpuLine.resize()})},convertime:function(e){var t=new Date(e),a=t.getHours(),i=t.getMinutes(),o=t.getSeconds(),s="";return a<10&&(s+="0"),s+=a+":",i<10&&(s+="0"),s+=i+":",o<10&&(s+="0"),s+=o,console.log(s),s},formatDate:function(e,t){/(y+)/.test(t)&&(t=t.replace(RegExp.$1,(e.getFullYear()+"").substr(4-RegExp.$1.length)));var a={"M+":e.getMonth()+1,"d+":e.getDate(),"h+":e.getHours(),"m+":e.getMinutes(),"s+":e.getSeconds()};for(var i in a)if(new RegExp("("+i+")").test(t)){var o=a[i]+"";t=t.replace(RegExp.$1,1===RegExp.$1.length?o:this.padLeftZero(o))}return t},handleClick:function(e,t){if("first"===e.name)this.tabinited.first||(this.popshowinit(),this.tabinited.first=!0,console.log("-----------------------------getDatalist"));else if("second"===e.name)if(600===this.projtypeid)this.tabinited.second||(this.showChartline(),this.tabinited.second=!0);else{var a=this.$createElement;this.$notify({title:"不是运维项目",message:a("i",{style:"color: teal"},"该项目不是运维项目，不能够查看主机状态")})}console.log(e,t)},getZbxhostsMessageByProjectid:function(){var e=this;this.$http({url:this.$http.adornUrl("/fenhuo/fenhuozabbixhost/zabbixHostsByProjectid"),method:"post",params:this.$http.adornParams({projectid:this.projectid})}).then(function(t){var a=t.data;if(a&&0===a.code){console.log(a.hosts);var i=a.hosts;e.zbxhosts=[];for(var o=0;o<i.length;o++){var s={};s.value=i[o].hostid,s.label=i[o].name,e.zbxhosts.push(s)}e.zbxAuthKey=a.authKey,e.zbxAuthId=a.id}else console.log(a)})},hostsChangeHandle:function(e,t){for(var a=this,i=0;i<this.zbxhosts.length;i++)if(this.zbxhosts[i].value===e){this.selectedhostname=this.zbxhosts[i].label;break}this.selectedItemid="",console.log("inputValue",e,", selectedHostid",this.selectedHostid),this.$http({url:this.$http.adornUrl("/fenhuo/fenhuozabbixhost/zabbixItemsByHostid"),method:"post",params:this.$http.adornParams({hostid:this.selectedHostid,authkey:this.zbxAuthKey,authid:this.zbxAuthId})}).then(function(e){var t=e.data;if(t&&0===t.code){a.zbxitems=[];for(var i=t.items.result,o=0;o<i.length;o++){var s={};s.value=i[o].itemid,s.label=i[o].key_,a.zbxitems.push(s)}console.log(t)}else console.log(t)})},itemChangeHandle:function(e){for(var t=0;t<this.zbxitems.length;t++)if(this.zbxitems[t].value===e){this.selectedItemname=this.zbxitems[t].label;break}console.log(e),console.log(this.selectedItemid),this.zbxitems.length>0?this.datepickenabled=!1:this.datepickenabled=!0},itemDateChangeHandle:function(e){this.from=this.dateTimeRange[0],this.till=this.dateTimeRange[1],this.initCPUChartLine()},handlePreview:function(e){console.log("handlePreview:"+e)},handleRemove:function(e,t){console.log("handleRemove file: "+o()(e)+"!!--!!fileList: "+o()(t))},onUploadStatuChange:function(e,t){this.fileList=t,console.log("onUploadStatuChange file: "+o()(e)+"!!--!!fileList: "+o()(t))},uploadSuccess:function(e,t,a){console.log("-----------------------uploadSuccess-------------"),console.log("response:"+o()(e)),console.log("file:"+o()(t)),console.log("fileList:"+o()(a))},uploadfile:function(e){console.log(e),this.uploadformdata.append("files",e.file)},uploadProjectFiles:function(e){this.fullscreenLoading=!0,this.submitUpload(e)},submitUpload:function(e){var t=this;this.uploadformdata=new FormData,this.$refs.upload.submit(),e?this.uploadformdata.append("deleteFiles",this.delfileIds):this.uploadformdata.append("deleteFiles",[]);l.a.post(this.$http.adornUrl("/fenhuo/fenhuoprojectinfo/upload/"+e+"?token="+this.$cookie.get("token")),this.uploadformdata,{headers:{"Content-Type":"multipart/form-data"}}).then(function(e){t.projectRelatedFilelist(),console.log(e)}).catch(function(e){console.log(e)})},deleteFileHandler:function(e,t){var a=void 0;for(a in this.fileList){var i=this.fileList[a];if(console.log("fileJson:"+o()(this.fileList[a])+",file uid:"+i.uid+", delUid:"+e),i.uid===e){this.projectid&&"success"===i.status&&this.delfileIds.push(i.fileid);break}}a>-1&&this.fileList.splice(a,1),console.log("deleted filelist:"+o()(this.fileList))}}},c={render:function(){var e=this,t=e.$createElement,a=e._self._c||t;return a("el-popover",{directives:[{name:"loading",rawName:"v-loading.fullscreen.lock",value:e.fullscreenLoading,expression:"fullscreenLoading",modifiers:{fullscreen:!0,lock:!0}}],attrs:{placement:"top",title:e.tabelTitle,width:"1300",trigger:e.showMathod,disabled:e.inactive},on:{hide:e.hideHandler,show:e.popshowinit}},[a("el-tabs",{attrs:{"tab-position":"right"},on:{"tab-click":e.handleClick},model:{value:e.activeName,callback:function(t){e.activeName=t},expression:"activeName"}},[a("el-tab-pane",{attrs:{label:"用户管理",name:"first"}},[a("el-row",[a("el-col",{attrs:{span:12}},[a("el-card",[a("div",{staticClass:"chart-box"},[a("el-collapse",{model:{value:e.collapseActiveName,callback:function(t){e.collapseActiveName=t},expression:"collapseActiveName"}},[a("el-collapse-item",{attrs:{title:"项目详细信息",name:"1"}},[a("div",[e._v("单位名称："),a("span",[e._v(e._s(e.orgname))])]),e._v(" "),a("el-divider"),e._v(" "),a("div",[e._v("详细地址："),a("span",[e._v(e._s(e.address))])]),e._v(" "),a("el-divider"),e._v(" "),a("div",[e._v("服务内容："),a("span",[e._v(e._s(e.servicedetail))])]),e._v(" "),a("el-divider"),e._v(" "),a("div",[e._v("服务有效时间："+e._s(e.effectivetime)+"天")]),e._v(" "),a("el-divider"),e._v(" "),a("div",[e._v("固定巡检时间："+e._s(e.taskname))]),e._v(" "),a("el-divider"),e._v(" "),a("div",[e._v("所在zabbix服务器："+e._s(e.zabbixname))]),e._v(" "),a("el-divider")],1),e._v(" "),a("el-collapse-item",{attrs:{title:"项目管理人员",name:"2"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.dataListLoading.mngloading,expression:"dataListLoading.mngloading"}],staticStyle:{width:"100%"},attrs:{data:e.dataList.mng,border:""}},e._l(e.mngerTbHeads,function(e){return a("el-table-column",{key:e.id,attrs:{prop:e.propname,label:e.labelname,width:e.widthvalue}})}))],1),e._v(" "),a("el-collapse-item",{attrs:{title:"项目甲方负责人员",name:"3"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.dataListLoading.Amngloading,expression:"dataListLoading.Amngloading"}],staticStyle:{width:"100%"},attrs:{data:e.dataList.Amng,border:""}},e._l(e.AmngeTbHeads,function(e){return a("el-table-column",{key:e.id,attrs:{prop:e.propname,label:e.labelname,width:e.widthvalue}})}))],1),e._v(" "),a("el-collapse-item",{attrs:{title:"项目维护人员",name:"4"}},[a("el-table",{directives:[{name:"loading",rawName:"v-loading",value:e.dataListLoading.maintainloading,expression:"dataListLoading.maintainloading"}],staticStyle:{width:"100%"},attrs:{data:e.dataList.maintain,border:""}},e._l(e.mainTainTbHeads,function(e){return a("el-table-column",{key:e.id,attrs:{prop:e.propname,label:e.labelname,width:e.widthvalue}})}))],1)],1)],1)])],1),e._v(" "),a("el-col",{attrs:{span:12}},[a("el-card",[a("el-row",{attrs:{gutter:20}},[a("el-col",{attrs:{span:6}},[a("el-container",[a("span",[a("h2",{staticStyle:{"line-height":"0px"}},[e._v("项目附件")])])])],1),e._v(" "),a("el-col",{attrs:{span:6,offset:12}},[a("el-upload",{ref:"upload",staticClass:"upload-demo",attrs:{action:"#","on-preview":e.handlePreview,"on-change":e.onUploadStatuChange,multiple:"","on-remove":e.handleRemove,"on-success":e.uploadSuccess,"file-list":e.fileList,"show-file-list":!1,"auto-upload":!1,"http-request":e.uploadfile}},[a("el-button",{attrs:{slot:"trigger",size:"small",type:"primary"},slot:"trigger"},[e._v("添加附件")])],1)],1)],1),e._v(" "),a("div",{staticClass:"chart-box",attrs:{id:"relatedfileid"}},[a("ul",{staticClass:"infinite-list",staticStyle:{overflow:"auto"}},[e._l(e.fileList,function(t){return a("el-row",{key:t.uid},[a("li",{staticClass:"infinite-list-item"},[a("el-col",{attrs:{span:8,offset:1}},[a("h3",[e._v(e._s(t.name))])]),e._v(" "),a("el-col",{attrs:{span:5,offset:10}},[a("el-link",{attrs:{type:"primary",underline:!1},on:{click:function(a){e.projectRelatedFileDownload(e.projectid,t.name)}}},[e._v("下载")]),e._v(" "),a("el-link",{attrs:{type:"primary",underline:!1},on:{click:function(a){e.deleteFileHandler(t.uid,t.name)}}},[e._v("删除")])],1)],1)])}),e._v(" "),a("span",{staticClass:"dialog-footer",attrs:{slot:"footer"},slot:"footer"},[a("el-button",{attrs:{type:"primary"},on:{click:function(t){e.uploadProjectFiles(e.projectid)}}},[e._v("更新文件")])],1)],2)])],1)],1)],1)],1),e._v(" "),a("el-tab-pane",{attrs:{label:"主机监控",name:"second"}},[a("div",{staticClass:"mod-demo-echarts"},[a("el-row",[a("el-col",{attrs:{span:24}},[a("el-card",{directives:[{name:"show",rawName:"v-show",value:600===e.projtypeid,expression:"projtypeid === 600? true:false"}]},[a("el-form",{staticStyle:{width:"100%"}},[a("el-form-item",{staticStyle:{width:"100%"}},[a("el-select",{attrs:{placeholder:"请选择主机"},on:{change:e.hostsChangeHandle},model:{value:e.selectedHostid,callback:function(t){e.selectedHostid=t},expression:"selectedHostid"}},e._l(e.zbxhosts,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}},[a("span",{staticStyle:{float:"left"}},[e._v(e._s(t.label))]),e._v(" "),a("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.value))])])}))],1),e._v(" "),a("el-form-item",{staticStyle:{width:"100%"}},[a("el-select",{attrs:{placeholder:"请选择监控项"},on:{change:e.itemChangeHandle},model:{value:e.selectedItemid,callback:function(t){e.selectedItemid=t},expression:"selectedItemid"}},e._l(e.zbxitems,function(t){return a("el-option",{key:t.value,attrs:{label:t.label,value:t.value}},[a("span",{staticStyle:{float:"left"}},[e._v(e._s(t.label))]),e._v(" "),a("span",{staticStyle:{float:"right",color:"#8492a6","font-size":"13px"}},[e._v(e._s(t.value))])])}))],1),e._v(" "),a("el-form-item",{staticStyle:{margin:"5px 0px"},attrs:{label:"监控日期"}},[a("el-date-picker",{attrs:{type:"datetimerange","range-separator":"-","start-placeholder":"开始日期","end-placeholder":"结束日期","value-format":"yyyy-MM-dd HH:mm:ss",disabled:e.datepickenabled},on:{change:e.itemDateChangeHandle},model:{value:e.dateTimeRange,callback:function(t){e.dateTimeRange=t},expression:"dateTimeRange"}})],1)],1),e._v(" "),a("div",{ref:"J_chartCPULineBox",staticClass:"chart-box",attrs:{id:"J_chartCPULineBox"}})],1)],1)],1)],1)])],1),e._v(" "),e._t("default",null,{slot:"reference"})],2)},staticRenderFns:[]};var h=a("46Yf")(d,c,!1,function(e){a("WNmw")},null,null);t.default=h.exports}});